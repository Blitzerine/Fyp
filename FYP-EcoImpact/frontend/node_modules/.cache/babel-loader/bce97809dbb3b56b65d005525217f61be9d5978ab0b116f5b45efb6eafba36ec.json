{"ast":null,"code":"/**\r\n * Utility functions for storing and retrieving simulation results\r\n */\n\nconst STORAGE_KEY = 'ecoimpact_simulations';\n\n/**\r\n * Save a simulation result to localStorage\r\n * @param {Object} simulationResult - The simulation result to save\r\n * @returns {string} - ID of the saved simulation\r\n */\nexport const saveSimulation = simulationResult => {\n  try {\n    const simulations = getSimulations();\n    const newSimulation = {\n      id: Date.now().toString() + Math.random().toString(36).substr(2, 9),\n      timestamp: new Date().toISOString(),\n      ...simulationResult\n    };\n    simulations.push(newSimulation);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(simulations));\n    return newSimulation.id;\n  } catch (error) {\n    console.error('Error saving simulation:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Get all saved simulations\r\n * @returns {Array} - Array of saved simulations\r\n */\nexport const getSimulations = () => {\n  try {\n    const stored = localStorage.getItem(STORAGE_KEY);\n    return stored ? JSON.parse(stored) : [];\n  } catch (error) {\n    console.error('Error retrieving simulations:', error);\n    return [];\n  }\n};\n\n/**\r\n * Remove a simulation by ID\r\n * @param {string} id - ID of the simulation to remove\r\n */\nexport const removeSimulation = id => {\n  try {\n    const simulations = getSimulations();\n    const filtered = simulations.filter(sim => sim.id !== id);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(filtered));\n  } catch (error) {\n    console.error('Error removing simulation:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Clear all simulations\r\n */\nexport const clearAllSimulations = () => {\n  try {\n    localStorage.removeItem(STORAGE_KEY);\n  } catch (error) {\n    console.error('Error clearing simulations:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Transform simulation result to comparison table format\r\n * @param {Object} simulationResult - The simulation result\r\n * @returns {Object} - Formatted data for comparison table\r\n */\nexport const formatSimulationForComparison = simulationResult => {\n  const {\n    inputs,\n    predictions,\n    countryContext,\n    success\n  } = simulationResult;\n\n  // Calculate CO₂ Covered from revenue and carbon price\n  // Formula: CO2_covered_tons = (annual_revenue_usd / carbon_price_usd_per_ton)\n  const annualRevenueMillionUSD = (predictions === null || predictions === void 0 ? void 0 : predictions.annualRevenueMillionUSD) || 0;\n  const carbonPriceUSD = (inputs === null || inputs === void 0 ? void 0 : inputs.carbonPriceUSD) || 0;\n  let co2CoveredMillionTons = null;\n  if (annualRevenueMillionUSD > 0 && carbonPriceUSD > 0) {\n    const annualRevenueUSD = annualRevenueMillionUSD * 1000000; // Convert to USD\n    const co2CoveredTons = annualRevenueUSD / carbonPriceUSD;\n    co2CoveredMillionTons = co2CoveredTons / 1000000; // Convert to million tons\n  }\n\n  // Calculate Revenue as % of GDP\n  const revenueUSD = annualRevenueMillionUSD * 1000000;\n  const gdpUSD = (countryContext === null || countryContext === void 0 ? void 0 : countryContext.gdpUSD) || (countryContext === null || countryContext === void 0 ? void 0 : countryContext.gdpPPP) || null;\n  let revenuePctGDP = null;\n  if (gdpUSD && gdpUSD > 0) {\n    revenuePctGDP = revenueUSD / gdpUSD * 100;\n  }\n  return {\n    id: simulationResult.id,\n    timestamp: simulationResult.timestamp,\n    country: (inputs === null || inputs === void 0 ? void 0 : inputs.country) || '',\n    policyType: (inputs === null || inputs === void 0 ? void 0 : inputs.policyType) === 'CARBON_TAX' ? 'Carbon Tax' : 'ETS',\n    carbonPrice: carbonPriceUSD,\n    duration: (inputs === null || inputs === void 0 ? void 0 : inputs.durationYears) || 0,\n    annualRevenue: annualRevenueMillionUSD,\n    co2Covered: co2CoveredMillionTons,\n    revenuePctGDP: revenuePctGDP,\n    successProbability: (success === null || success === void 0 ? void 0 : success.success_probability) || null,\n    riskLevel: (success === null || success === void 0 ? void 0 : success.risk_level) || null,\n    status: (success === null || success === void 0 ? void 0 : success.status) || null\n  };\n};","map":{"version":3,"names":["STORAGE_KEY","saveSimulation","simulationResult","simulations","getSimulations","newSimulation","id","Date","now","toString","Math","random","substr","timestamp","toISOString","push","localStorage","setItem","JSON","stringify","error","console","stored","getItem","parse","removeSimulation","filtered","filter","sim","clearAllSimulations","removeItem","formatSimulationForComparison","inputs","predictions","countryContext","success","annualRevenueMillionUSD","carbonPriceUSD","co2CoveredMillionTons","annualRevenueUSD","co2CoveredTons","revenueUSD","gdpUSD","gdpPPP","revenuePctGDP","country","policyType","carbonPrice","duration","durationYears","annualRevenue","co2Covered","successProbability","success_probability","riskLevel","risk_level","status"],"sources":["D:/Fyp/FYP-EcoImpact/frontend/src/utils/simulationStorage.js"],"sourcesContent":["/**\r\n * Utility functions for storing and retrieving simulation results\r\n */\r\n\r\nconst STORAGE_KEY = 'ecoimpact_simulations';\r\n\r\n/**\r\n * Save a simulation result to localStorage\r\n * @param {Object} simulationResult - The simulation result to save\r\n * @returns {string} - ID of the saved simulation\r\n */\r\nexport const saveSimulation = (simulationResult) => {\r\n  try {\r\n    const simulations = getSimulations();\r\n    const newSimulation = {\r\n      id: Date.now().toString() + Math.random().toString(36).substr(2, 9),\r\n      timestamp: new Date().toISOString(),\r\n      ...simulationResult\r\n    };\r\n    \r\n    simulations.push(newSimulation);\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(simulations));\r\n    \r\n    return newSimulation.id;\r\n  } catch (error) {\r\n    console.error('Error saving simulation:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get all saved simulations\r\n * @returns {Array} - Array of saved simulations\r\n */\r\nexport const getSimulations = () => {\r\n  try {\r\n    const stored = localStorage.getItem(STORAGE_KEY);\r\n    return stored ? JSON.parse(stored) : [];\r\n  } catch (error) {\r\n    console.error('Error retrieving simulations:', error);\r\n    return [];\r\n  }\r\n};\r\n\r\n/**\r\n * Remove a simulation by ID\r\n * @param {string} id - ID of the simulation to remove\r\n */\r\nexport const removeSimulation = (id) => {\r\n  try {\r\n    const simulations = getSimulations();\r\n    const filtered = simulations.filter(sim => sim.id !== id);\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(filtered));\r\n  } catch (error) {\r\n    console.error('Error removing simulation:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Clear all simulations\r\n */\r\nexport const clearAllSimulations = () => {\r\n  try {\r\n    localStorage.removeItem(STORAGE_KEY);\r\n  } catch (error) {\r\n    console.error('Error clearing simulations:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Transform simulation result to comparison table format\r\n * @param {Object} simulationResult - The simulation result\r\n * @returns {Object} - Formatted data for comparison table\r\n */\r\nexport const formatSimulationForComparison = (simulationResult) => {\r\n  const { inputs, predictions, countryContext, success } = simulationResult;\r\n  \r\n  // Calculate CO₂ Covered from revenue and carbon price\r\n  // Formula: CO2_covered_tons = (annual_revenue_usd / carbon_price_usd_per_ton)\r\n  const annualRevenueMillionUSD = predictions?.annualRevenueMillionUSD || 0;\r\n  const carbonPriceUSD = inputs?.carbonPriceUSD || 0;\r\n  let co2CoveredMillionTons = null;\r\n  if (annualRevenueMillionUSD > 0 && carbonPriceUSD > 0) {\r\n    const annualRevenueUSD = annualRevenueMillionUSD * 1000000; // Convert to USD\r\n    const co2CoveredTons = annualRevenueUSD / carbonPriceUSD;\r\n    co2CoveredMillionTons = co2CoveredTons / 1000000; // Convert to million tons\r\n  }\r\n  \r\n  // Calculate Revenue as % of GDP\r\n  const revenueUSD = annualRevenueMillionUSD * 1000000;\r\n  const gdpUSD = countryContext?.gdpUSD || countryContext?.gdpPPP || null;\r\n  let revenuePctGDP = null;\r\n  if (gdpUSD && gdpUSD > 0) {\r\n    revenuePctGDP = (revenueUSD / gdpUSD) * 100;\r\n  }\r\n  \r\n  return {\r\n    id: simulationResult.id,\r\n    timestamp: simulationResult.timestamp,\r\n    country: inputs?.country || '',\r\n    policyType: inputs?.policyType === 'CARBON_TAX' ? 'Carbon Tax' : 'ETS',\r\n    carbonPrice: carbonPriceUSD,\r\n    duration: inputs?.durationYears || 0,\r\n    annualRevenue: annualRevenueMillionUSD,\r\n    co2Covered: co2CoveredMillionTons,\r\n    revenuePctGDP: revenuePctGDP,\r\n    successProbability: success?.success_probability || null,\r\n    riskLevel: success?.risk_level || null,\r\n    status: success?.status || null\r\n  };\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}